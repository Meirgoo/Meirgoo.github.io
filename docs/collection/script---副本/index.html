<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Script
  #


  powershell
  #


  文件批量重命名
  #

Get-ChildItem *.epub | Rename-Item -Newname{ $_.Name -replace &rsquo; - 未知&rsquo;,&rsquo;&#39;}

  卸除windows内置应用，保留windows商店和AppInstaller
  #

get-appxpackage|where{$.name -notmatch &ldquo;Store&rdquo;}|where{$.name -notmatch &ldquo;Installer&rdquo;}|remove-appxpackage

  恢复微软商店
  #

Get-AppxPackage -AllUsers Microsoft.WindowsStore* | Foreach {Add-AppxPackage -DisableDevelopmentMode -Register &ldquo;$($_.InstallLocation)\AppXManifest.xml&rdquo;}

  切换win11右键菜单
  #

reg add &#34;HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32&#34; /f /ve
taskkill /f /im explorer.exe &amp; start explorer.exe

  切换win10右键菜单
  #

reg delete &#34;HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}&#34; /f
taskkill /f /im explorer.exe &amp; start explorer.exe 

  关闭 xbox game bar
  #

reg add &#34;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\GameDVR&#34; /v &#34;AppCaptureEnabled&#34; /t &#34;REG_DWORD&#34; /d &#34;0&#34; /f
reg add &#34;HKCU\System\GameConfigStore&#34; /v &#34;GameDVR_Enabled&#34; /t &#34;REG_DWORD&#34; /d &#34;0&#34; /f
Calibre转换txt为epub设置
中文语境下获取章节目录设置
//*[re:test(., &#34;^\s*(简介|内容简介|序|楔子|尾声|后记|番外|[第卷][0123456789一二三四五六七八九十零〇百千两]*[卷回部章节])\s*([^课].*|)$&#34;, &#34;i&#34;)]
行间距设置
p{
    text-indent:2em;/* 中文小说段首必备两个字的缩进*/
    line-height:1.5em; /*设置行间距，这样段落里面每一行之间的间距就有半个字体大小的间距*/
    margin:1em 0; /*上下各有0.5em的外边距，这样段间距就是2em也就是2个字体大小，也可以设置成0.5em，看喜好 */
}
替换标签p为h2">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/docs/collection/script---%E5%89%AF%E6%9C%AC/">
  <meta property="og:site_name" content="Meirgoo Site">
  <meta property="og:title" content="Script">
  <meta property="og:description" content="Script#powershell#文件批量重命名#Get-ChildItem *.epub | Rename-Item -Newname{ $_.Name -replace ’ - 未知’,’&#39;}
卸除windows内置应用，保留windows商店和AppInstaller#get-appxpackage|where{$.name -notmatch “Store”}|where{$.name -notmatch “Installer”}|remove-appxpackage
恢复微软商店#Get-AppxPackage -AllUsers Microsoft.WindowsStore* | Foreach {Add-AppxPackage -DisableDevelopmentMode -Register “$($_.InstallLocation)\AppXManifest.xml”}
切换win11右键菜单#reg add &#34;HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32&#34; /f /ve taskkill /f /im explorer.exe &amp; start explorer.exe 切换win10右键菜单#reg delete &#34;HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}&#34; /f taskkill /f /im explorer.exe &amp; start explorer.exe 关闭 xbox game bar#reg add &#34;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\GameDVR&#34; /v &#34;AppCaptureEnabled&#34; /t &#34;REG_DWORD&#34; /d &#34;0&#34; /f reg add &#34;HKCU\System\GameConfigStore&#34; /v &#34;GameDVR_Enabled&#34; /t &#34;REG_DWORD&#34; /d &#34;0&#34; /f Calibre转换txt为epub设置
中文语境下获取章节目录设置
//*[re:test(., &#34;^\s*(简介|内容简介|序|楔子|尾声|后记|番外|[第卷][0123456789一二三四五六七八九十零〇百千两]*[卷回部章节])\s*([^课].*|)$&#34;, &#34;i&#34;)] 行间距设置
p{ text-indent:2em;/* 中文小说段首必备两个字的缩进*/ line-height:1.5em; /*设置行间距，这样段落里面每一行之间的间距就有半个字体大小的间距*/ margin:1em 0; /*上下各有0.5em的外边距，这样段间距就是2em也就是2个字体大小，也可以设置成0.5em，看喜好 */ } 替换标签p为h2">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>Script | Meirgoo Site</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/docs/collection/script---%E5%89%AF%E6%9C%AC/">
<link rel="stylesheet" href="/book.min.a7616cf2799b58bddffce9438e31fdbfc6393687cfc0950a4a17cd1cce7e35f6.css" integrity="sha256-p2Fs8nmbWL3f/OlDjjH9v8Y5NofPwJUKShfNHM5&#43;NfY=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.450fa9eda1542d5635bba0d271e3207d3e0adf3f3257c328a6daeeb8aaa0dbc5.js" integrity="sha256-RQ&#43;p7aFULVY1u6DSceMgfT4K3z8yV8MoptruuKqg28U=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Meirgoo Site</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Collection</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/collection/script---%E5%89%AF%E6%9C%AC/" class="active">Script</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/collection/script/" class="">Script</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/collection/website/" class="">Site</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <span>Project</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/project/simplereader/" class="">Simple Reader</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Script</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#powershell">powershell</a>
      <ul>
        <li><a href="#文件批量重命名">文件批量重命名</a></li>
        <li><a href="#卸除windows内置应用保留windows商店和appinstaller">卸除windows内置应用，保留windows商店和AppInstaller</a></li>
        <li><a href="#恢复微软商店">恢复微软商店</a></li>
        <li><a href="#切换win11右键菜单">切换win11右键菜单</a></li>
        <li><a href="#切换win10右键菜单">切换win10右键菜单</a></li>
        <li><a href="#关闭-xbox-game-bar">关闭 xbox game bar</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="script">
  Script
  <a class="anchor" href="#script">#</a>
</h1>
<h2 id="powershell">
  powershell
  <a class="anchor" href="#powershell">#</a>
</h2>
<h3 id="文件批量重命名">
  文件批量重命名
  <a class="anchor" href="#%e6%96%87%e4%bb%b6%e6%89%b9%e9%87%8f%e9%87%8d%e5%91%bd%e5%90%8d">#</a>
</h3>
<p>Get-ChildItem *.epub | Rename-Item -Newname{ $_.Name -replace &rsquo; - 未知&rsquo;,&rsquo;'}</p>
<h3 id="卸除windows内置应用保留windows商店和appinstaller">
  卸除windows内置应用，保留windows商店和AppInstaller
  <a class="anchor" href="#%e5%8d%b8%e9%99%a4windows%e5%86%85%e7%bd%ae%e5%ba%94%e7%94%a8%e4%bf%9d%e7%95%99windows%e5%95%86%e5%ba%97%e5%92%8cappinstaller">#</a>
</h3>
<p>get-appxpackage|where{$<em>.name -notmatch &ldquo;Store&rdquo;}|where{$</em>.name -notmatch &ldquo;Installer&rdquo;}|remove-appxpackage</p>
<h3 id="恢复微软商店">
  恢复微软商店
  <a class="anchor" href="#%e6%81%a2%e5%a4%8d%e5%be%ae%e8%bd%af%e5%95%86%e5%ba%97">#</a>
</h3>
<p>Get-AppxPackage -AllUsers Microsoft.WindowsStore* | Foreach {Add-AppxPackage -DisableDevelopmentMode -Register &ldquo;$($_.InstallLocation)\AppXManifest.xml&rdquo;}</p>
<h3 id="切换win11右键菜单">
  切换win11右键菜单
  <a class="anchor" href="#%e5%88%87%e6%8d%a2win11%e5%8f%b3%e9%94%ae%e8%8f%9c%e5%8d%95">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">reg</span> <span style="color:#a6e22e">add</span> <span style="color:#e6db74">&#34;HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32&#34;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">f</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">ve</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">taskkill</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">f</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">im</span> <span style="color:#a6e22e">explorer</span>.<span style="color:#a6e22e">exe</span> <span style="color:#f92672">&amp;</span> <span style="color:#a6e22e">start</span> <span style="color:#a6e22e">explorer</span>.<span style="color:#a6e22e">exe</span>
</span></span></code></pre></div><h3 id="切换win10右键菜单">
  切换win10右键菜单
  <a class="anchor" href="#%e5%88%87%e6%8d%a2win10%e5%8f%b3%e9%94%ae%e8%8f%9c%e5%8d%95">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">reg</span> <span style="color:#66d9ef">delete</span> <span style="color:#e6db74">&#34;HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}&#34;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">f</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">taskkill</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">f</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">im</span> <span style="color:#a6e22e">explorer</span>.<span style="color:#a6e22e">exe</span> <span style="color:#f92672">&amp;</span> <span style="color:#a6e22e">start</span> <span style="color:#a6e22e">explorer</span>.<span style="color:#a6e22e">exe</span> 
</span></span></code></pre></div><h3 id="关闭-xbox-game-bar">
  关闭 xbox game bar
  <a class="anchor" href="#%e5%85%b3%e9%97%ad-xbox-game-bar">#</a>
</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">reg</span> <span style="color:#a6e22e">add</span> <span style="color:#e6db74">&#34;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\GameDVR&#34;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">v</span> <span style="color:#e6db74">&#34;AppCaptureEnabled&#34;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">t</span> <span style="color:#e6db74">&#34;REG_DWORD&#34;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">d</span> <span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">f</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">reg</span> <span style="color:#a6e22e">add</span> <span style="color:#e6db74">&#34;HKCU\System\GameConfigStore&#34;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">v</span> <span style="color:#e6db74">&#34;GameDVR_Enabled&#34;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">t</span> <span style="color:#e6db74">&#34;REG_DWORD&#34;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">d</span> <span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">f</span>
</span></span></code></pre></div><p>Calibre转换txt为epub设置</p>
<p>中文语境下获取章节目录设置</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#75715e">//*[re:test(., &#34;^\s*(简介|内容简介|序|楔子|尾声|后记|番外|[第卷][0123456789一二三四五六七八九十零〇百千两]*[卷回部章节])\s*([^课].*|)$&#34;, &#34;i&#34;)]
</span></span></span></code></pre></div><p>行间距设置</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span><span style="color:#f92672">p</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">text-indent</span>:<span style="color:#ae81ff">2</span><span style="color:#66d9ef">em</span>;<span style="color:#75715e">/* 中文小说段首必备两个字的缩进*/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">line-height</span>:<span style="color:#ae81ff">1.5</span><span style="color:#66d9ef">em</span>; <span style="color:#75715e">/*设置行间距，这样段落里面每一行之间的间距就有半个字体大小的间距*/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">margin</span>:<span style="color:#ae81ff">1</span><span style="color:#66d9ef">em</span> <span style="color:#ae81ff">0</span>; <span style="color:#75715e">/*上下各有0.5em的外边距，这样段间距就是2em也就是2个字体大小，也可以设置成0.5em，看喜好 */</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>替换标签p为h2</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;(<span style="color:#960050;background-color:#1e0010">\</span><span style="color:#a6e22e">s</span><span style="color:#f92672">*</span>(<span style="color:#a6e22e">简介</span><span style="color:#f92672">|</span><span style="color:#a6e22e">内容简介</span><span style="color:#f92672">|</span><span style="color:#a6e22e">序</span><span style="color:#f92672">|</span><span style="color:#a6e22e">楔子</span><span style="color:#f92672">|</span><span style="color:#a6e22e">尾声</span><span style="color:#f92672">|</span><span style="color:#a6e22e">后记</span><span style="color:#f92672">|</span><span style="color:#a6e22e">番外</span><span style="color:#f92672">|</span>[<span style="color:#a6e22e">第卷</span>][<span style="color:#ae81ff">0123456789</span><span style="color:#a6e22e">一二三四五六七八九十零〇百千两</span>]<span style="color:#f92672">*</span>[<span style="color:#a6e22e">卷回部章节</span>])<span style="color:#960050;background-color:#1e0010">\</span><span style="color:#a6e22e">s</span><span style="color:#f92672">*</span>([<span style="color:#f92672">^</span><span style="color:#a6e22e">课</span>].<span style="color:#f92672">*|</span>))&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> &lt;<span style="color:#f92672">h2</span>&gt;<span style="color:#960050;background-color:#1e0010">\</span><span style="color:#ae81ff">1</span>&lt;/<span style="color:#f92672">h2</span>&gt;
</span></span></code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#powershell">powershell</a>
      <ul>
        <li><a href="#文件批量重命名">文件批量重命名</a></li>
        <li><a href="#卸除windows内置应用保留windows商店和appinstaller">卸除windows内置应用，保留windows商店和AppInstaller</a></li>
        <li><a href="#恢复微软商店">恢复微软商店</a></li>
        <li><a href="#切换win11右键菜单">切换win11右键菜单</a></li>
        <li><a href="#切换win10右键菜单">切换win10右键菜单</a></li>
        <li><a href="#关闭-xbox-game-bar">关闭 xbox game bar</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












